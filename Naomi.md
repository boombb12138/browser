---
timezone: Pacific/Auckland
---

> 请在上边的 timezone 添加你的当地时区，这会有助于你的打卡状态的自动化更新，如果没有添加，默认为北京时间 UTC+8 时区
> 时区请参考以下列表，请移除 # 以后的内容

timezone: Pacific/Honolulu # 夏威夷-阿留申标准时间 (UTC-10)

timezone: America/Anchorage # 阿拉斯加标准时间 (UTC-9)

timezone: America/Los_Angeles # 太平洋标准时间 (UTC-8)

timezone: America/Denver # 山地标准时间 (UTC-7)

timezone: America/Chicago # 中部标准时间 (UTC-6)

timezone: America/New_York # 东部标准时间 (UTC-5)

timezone: America/Halifax # 大西洋标准时间 (UTC-4)

timezone: America/St_Johns # 纽芬兰标准时间 (UTC-3:30)

timezone: America/Sao_Paulo # 巴西利亚时间 (UTC-3)

timezone: Atlantic/Azores # 亚速尔群岛时间 (UTC-1)

timezone: Europe/London # 格林威治标准时间 (UTC+0)

timezone: Europe/Berlin # 中欧标准时间 (UTC+1)

timezone: Europe/Helsinki # 东欧标准时间 (UTC+2)

timezone: Europe/Moscow # 莫斯科标准时间 (UTC+3)

timezone: Asia/Dubai # 海湾标准时间 (UTC+4)

timezone: Asia/Kolkata # 印度标准时间 (UTC+5:30)

timezone: Asia/Dhaka # 孟加拉国标准时间 (UTC+6)

timezone: Asia/Bangkok # 中南半岛时间 (UTC+7)

timezone: Asia/Shanghai # 中国标准时间 (UTC+8)

timezone: Asia/Tokyo # 日本标准时间 (UTC+9)

timezone: Australia/Sydney # 澳大利亚东部标准时间 (UTC+10)

timezone: Pacific/Auckland # 新西兰标准时间 (UTC+12)

---

# {Naomi}

1. 自我介绍
2. 你认为你会完成本次残酷学习吗？必须的

## Notes

<!-- Content_START -->

### 2024.09.19
# Chapter3运输层

运输层位于应用层和网络层之间，是分层的网络体系结构的重要部分。主要关注TCP和UDP运输层协议

# 3.1 运输层服务

发送端的应用程序-》发送端运输层-〉发送端网络层-》接受端网络层-》接受端运输层

- **发送端应用程序 → 发送端运输层**：
    - 发送端的应用程序将数据发送给运输层。运输层会将应用程序的数据分割成较小的块（报文段，segment），并为每个报文段加上运输层首部。运输层的首部包含端口号、序列号、校验和等信息，以便在接收端进行数据的重组和校验。
- **发送端运输层 → 发送端网络层**：
    - 运输层将封装好的报文段交给网络层。网络层会将报文段封装进网络层的数据报（数据包），并加上网络层首部，通常包括源 IP 地址、目的 IP 地址等信息。
- **发送端网络层 → 接收端网络层**：
    - 网络层将封装好的数据报通过路由器传递到网络中的下一个节点，经过多个路由器转发，最终到达目的地网络层。路由器只处理数据报的网络层信息（例如 IP 地址），而不关心封装在数据报中的运输层报文段。

运输层的类比：2个家庭间的通信，Ann和Bill负责各自家庭内部的收发邮件

Ann和Bill都是在各自家里进行工作的;例如，他们并没有参与任何一个中间邮件中心对邮件进行分拣，或者将邮件从一个邮件中心送到另一个邮件中心之类的工作。类似地，运输层协议只工作在端系统中。在端系统中，运输层协议将来自应用进程的报文移动到网络边缘(即网络层)但对有关这些报文在网络核心如何移动并不作任何规定。事实上，如图3-1所示，中间路由器既不处理也不识别运输层加在应用层报文的任何信息

UDP(用户数据报协议)，它为调用它的应用程序提供了一种不可靠、无连接的服务。另一种是TCP(传输控制协议)，它为调用它的应用程序提供了一种可靠的、面向连接的服务

每台主机有一个IP地址。因特网网络层协议有一个名字叫IP，即网际协议。IP为主机之间提供了逻辑通信。

UDP 和 TCP 的主要职责之一就是在 IP 提供的**主机到主机**传递服务的基础上，进一步扩展为**进程到进程**的传递服务。主机间的信息传递因为有UDP和TCP的存在，扩展成了端系统上的两个进程之间的信息传递

### 2024.09.20

### 2024.09.21

# 3.2多路复用与多路分解

在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息(这将在以后用于分解)从而生成报文段，然后将报文段传递到网络层，所有这些工作称为多路复用(multiplexing)

一个进程(作为网络应用的一部分)有一个或多个套接字(socket)，在接收主机中的运输层际上并没有直接将数据交付给进程，而是将数据交给了一个中间的套接字，套接字有唯一的端口号，在报文中有目的端口号，当报文段到达主机时，运输层检查报文段中的目的端口号，并将其定向到相应的套接字，这个过程称为多路分解(demultiplexing)。

多路复用发生在发送端，多路分解发生在接收端

服务器在12000端口等待连接，客户端发送请求连接，服务器收到请求连接到报文后，根据报文中的:①该报文段中的源端口号;②源主机IP地址;③该报文段中的目的端口号;④自身的IP地址。创建套接字， 如果后续到达的报文的4个值和该请求报文的一样，则会被分配到这个套接字

连接套接字与进程之间并非总是有着一一对应的关系。事实上，当今的高性能Web服务器通常只使用一个进程，但是为每个新的客户连接创建一个具有新连接套接字的新线程。

# 3.3UDP

运输层最低限度必须提供一种复用/分解服务.UDP只是做了运输协议能够做的最少工作

将报文段中的数据交付给正确的应用进程。值得注意的是，使用UDP时，在发送报文段之前，发送方和接收方的运输层实体之间没有握手。正因为如此，UDP被称为是无连接的

DNS是使用UDP的应用层协议  HTTP使用TCP

因为有许多应用更适合用UDP，原因主要以下几点:

- 比较快 UDP就会将此数据打包进UDP报文段并立即将其传递给网络层
- 无连接状态

UDP应用：

因特网电话、实时视频会议、流式存储音频与视频

TCP应用：

电子邮件、远程终端访问、Web及文件传输

### 差错检测

检测当UDP报文段从源到达目的地移动时，其中的比特是否发生了改变

因为无法确保每条链路都使用有差错检测的协议，也无法确保内存中的差错检测（指的是数据从一个应用程序到另一个应用程序的过程出现错误或者是应用程序内部错误），所以UDP就必须在端到端基础上在运输层提供差错检测。

# 3.4可靠数据传输原理

## 3.4.1构造可靠数据传输协议

1. 假设底层信道是完全可靠的。
2. 假设分组中的比特可能受损，但是所有发送的分组(虽然有些比特可能受损)将按其发送的顺序被接收
    
    如果报文接收者听到一句含糊不清的话时，他可能要求你重复那句容易误解的话。这种口述报文协议使用了肯定确认(positive ac-knowledgment)(“OK”) ACK（ac-knowledgment)与否定确认(negative acknowledgment)(“请重复一遍”)NCK。基于这样重传机制的可靠数据传输协议称为自动重传请求协议。
    
    发送方收到上层信息，发送分组-等待接受方的ACK或NAK分组-若为NAK或是上一个分组的ACK，就重新传输；若为ACK就等待上层数据（发送方将不会发送一块新数据，除非发送方确信接收方已正确接收当前分组。）这样的协议称为停等(stop-and-wait)协议。
    
3. 考虑到ACK或NAK分组受损的可能性
    
    当发送方收到含糊不清的ACK或NAK分组时，只需重传当前分组-》冗余分组（接收方不知道这个分组是新的还是重传）-〉发送方对分组编号，如果编号一样就是重传
    
    比特交替协议（rdt3.0)：分组序号在0和1之间交替
    
    ![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/a6ca9822-e902-41f9-90d9-747f9ae75db0/9eb2bdc2-f3ad-4599-b55e-a13acab844ff/image.png)
    

### 3.4.2流水线可靠数据传输协议

rdt3.0因为是一个停等协议，所以有效吞吐量很低，即使底层网络硬件的传输速率很好，也被协议限制了传输速度

有效吞吐量=成功传输的数据量/总传输时间

解决方法：允许发送方发送多个分组而无须等待确认。因为许多从发送方向接收方输送的分组可以被看成是填充到一条流水线中，所以这种技术被称为流水线。要实现流水线，就必须：
1. 增加序号范围 因为每个输送中的分组必须有一个唯一的序号

1. 发送方和接收方要缓存多个分组

解决流水线的差错恢复有两种基本方法是:回退N步(Go-Back-N，GBN)和选择重传(Selective Repeat，SR)。

### **3.4.3 回退N步**

**GBN 协议的工作机制**

- **发送方**：可以一次发送多个分组，但发送窗口内的分组数量不能超过 `N`（窗口大小）。当发送方发送分组时，它不会等待每个分组的单独确认，而是通过滑动窗口机制管理这些分组。 假设窗口长度是4，那么发送方发送了0-3个分组后，必须等待分组确认（当收到一个ACK0的时候，窗口就向前移动，发送方就可以发送新的分组）
- **接收方**：
    - 期望按序接收分组。
    - 只会将按序到达的分组交付给上层，即分组的序列号必须是接收方期望的下一个序列号（按序号递增）。
    - 如果接收到的分组序号正好是期望的分组（如当前期望的是分组 `n`，而接收到了序列号为 `n` 的分组），则接收方会将该分组交付给上层，并发送一个累积确认（ACK n），表明所有序列号小于等于 `n` 的分组都已经成功接收。如果接收方收到的分组不是当前期望的序列号（即乱序到达），则会丢弃该分组并重发上次按序收到的分组的确认。

### **3.4.4 选择重传**

<!-- Content_END -->
